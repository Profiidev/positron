services:
  frontend:
    build:
      context: .
      dockerfile: frontend/Dockerfile.Dev
    volumes:
      - ./frontend:/app/frontend
      - ./node_modules:/app/node_modules
      - ./package-lock.json:/app/package-lock.json
      - ./package.json:/app/package.json
    networks:
      - nginx
    ports:
      - "1234:1420"
    command: npm run dev -- --host

  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile.Dev
    volumes:
      - ./backend:/app
    networks:
      - nginx
    command: cargo watch -x run

  nginx:
    image: nginx:latest
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    ports:
      - "1420:1420"
    networks:
      - nginx
    environment:
      - NGINX_ENTRYPOINT_QUIET_LOGS=1

networks:
  nginx:
